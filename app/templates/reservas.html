{% extends 'base.html' %}

{% block title %}Reservas | LabFlow{% endblock %}

{% block content %}
    <div class="card p-4 bg-dark bg-opacity-75 text-white rounded-4" style="max-width: 900px; margin: auto;">
        <h2 class="mb-3">Agendamento de Laboratórios</h2>
        <p>Selecione o horário desejado no calendário abaixo.</p>

        <div id="calendar" class="bg-light rounded-3 p-2"></div>
    </div>
{% endblock %}

{% block extra_scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'timeGridWeek',
      locale: 'pt-br',
      slotMinTime: "07:00:00",
      slotMaxTime: "22:00:00",
      allDaySlot: false,
      selectable: true,
      events: '/reservas/json/',
      select: function (info) {
        const dia = info.startStr.split("T")[0];
        const inicio = info.startStr.split("T")[1];
        const fim = info.endStr.split("T")[1];
        window.location.href = `/reservas/nova/?data=${dia}&inicio=${inicio}&fim=${fim}`;
      }
    });
    calendar.render();
  });
</script>
{% endblock %}
